<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆãƒ•ã‚©ãƒ¼ãƒ </title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; }
    .panel-tab {
      cursor: pointer;
      border-bottom: 2px solid transparent;
      padding: 0.5rem 1rem;
      color: #555;
    }
    .panel-tab.active {
      border-color: #0d6efd;
      font-weight: bold;
      color: #0d6efd;
    }
    .panel-content { display: none; }
    .panel-content.active { display: block; animation: fadeIn 0.3s ease-in-out; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateX(15px); }
      to { opacity: 1; transform: translateX(0); }
    }
    .card + .card { margin-top: 1.5rem; }
    .card-header {
      background-color: #e9f4fb;
      font-weight: bold;
      color: #1a5e7a;
    }
    .form-wrapper {
      background-color: #fff;
      border-radius: 1rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 2rem;
      max-width: 720px;
      margin: 0 auto;
    }
  .highlight-empty {
    background-color: #fffef0 !important; /* è–„ã„é»„è‰² */
  }
  .accordion-button.keep-bg {
    background-color: #e9f4fb !important;
    color: #1a5e7a;
    font-weight: bold;
    border: none;
    box-shadow: none;
  }
  .accordion-button.keep-bg.collapsed {
    background-color: #e9f4fb !important;
  }
/* ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã®è¦‹å‡ºã—ã®é«˜ã•ã‚’ã‚«ãƒ¼ãƒ‰ã¨åŒã˜ãã‚‰ã„ã«ã™ã‚‹ */
.accordion-button.keep-bg {
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  min-height: auto;
}
.card-header {
  font-size: 1.1rem; }

.accordion-button.keep-bg {
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
  font-size: 1.1rem;
  min-height: auto;
}

  </style>
</head>
<body>
<div class="container my-5">
  <h3 class="text-center mb-4">ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆãƒ•ã‚©ãƒ¼ãƒ </h3>

  <!-- ã‚¿ãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
  <div class="d-flex justify-content-center mb-3 flex-wrap">
    <div class="panel-tab active" onclick="showPanel('basic')">åŸºæœ¬æƒ…å ±</div>
    <div class="panel-tab" onclick="showPanel('body')">èº«ä½“ã®çŠ¶æ³</div>
    <div class="panel-tab" onclick="showPanel('adl')">æ—¥å¸¸ç”Ÿæ´»å‹•ä½œ</div>
    <div class="panel-tab" onclick="showPanel('notes')">ç‰¹è¨˜äº‹é …</div>
  </div>

  <!-- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
  <form method="POST" class="form-wrapper">

    <!-- â–¼ åŸºæœ¬æƒ…å ± -->
    <div class="panel-content active" id="panel-basic">
      <div class="card">
        <div class="card-header">åˆ©ç”¨è€…æƒ…å ±</div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label">åˆ©ç”¨è€…æ°å</label>
            <input type="text" class="form-control" name="name" value="{{ resident.name }}" readonly>
          </div>
          <div class="row mb-3">
            <div class="col-md-3">
              <label class="form-label">æ€§åˆ¥</label>
              <input type="text" class="form-control" value="{{ resident.gender }}" readonly>
            </div>
            <div class="col-md-9">
              <label class="form-label">ç”Ÿå¹´æœˆæ—¥ï¼ˆå’Œæš¦ï¼‰</label>
              <div class="d-flex align-items-center gap-1 flex-nowrap">
                <input type="text" class="form-control" style="width: 80px;" value="{{ resident.birth_era }}" readonly>
                <input type="text" class="form-control" style="width: 60px;" value="{{ resident.birth_year_wa }}" readonly>
                <span class="small">å¹´</span>
                <input type="text" class="form-control" style="width: 50px;" value="{{ resident.birth_month }}" readonly>
                <span class="small">æœˆ</span>
                <input type="text" class="form-control" style="width: 50px;" value="{{ resident.birth_day }}" readonly>
                <span class="small">æ—¥</span>
              </div>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-8">
              <label class="form-label">ä½æ‰€</label>
              <input type="text" class="form-control" value="{{ resident.address }}" readonly>
            </div>
            <div class="col-md-4">
              <label class="form-label">é€£çµ¡å…ˆ</label>
              <input type="text" class="form-control" value="{{ resident.phone }}" readonly>
            </div>
          </div>

<div class="row mb-3">
  <!-- ä½œæˆæ—¥ï¼ˆåˆæœŸå€¤ã«ä»Šæ—¥ã®æ—¥ä»˜ï¼‰ -->
  <div class="col-md-3">
    <label class="form-label">ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆä½œæˆæ—¥</label>
    <input type="date" name="created_at" class="form-control" value="{{ today }}">
  </div>

  <!-- ç†ç”± -->
  <div class="col-md-3">
    <label class="form-label">ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆç†ç”±</label>
    <select name="reason" class="form-select">
      <option value="">é¸æŠ</option>
      <option value="æ–°è¦">æ–°è¦</option>
      <option value="æ›´æ–°">æ›´æ–°</option>
      <option value="åŒºåˆ†å¤‰æ›´">åŒºåˆ†å¤‰æ›´</option>
      <option value="é€€é™¢">é€€é™¢</option>
      <option value="æƒ…å ±æä¾›">æƒ…å ±æä¾›</option>
    </select>
  </div>

  <!-- é¢è«‡å ´æ‰€ -->
  <div class="col-md-3">
    <label class="form-label">é¢è«‡å ´æ‰€</label>
    <select name="interview_place" class="form-select">
      <option value="">é¸æŠ</option>
      <option value="å±…å®¤">å±…å®¤</option>
      <option value="è‡ªå®…">è‡ªå®…</option>
      <option value="ç—…é™¢">ç—…é™¢</option>
      <option value="æ–½è¨­">æ–½è¨­</option>
    </select>
  </div>

  <!-- ä½œæˆè€…ï¼ˆã‚±ã‚¢ãƒãƒï¼‰ -->
  <div class="col-md-3">
    <label class="form-label">ä½œæˆè€…</label>
    <input type="text" class="form-control" name="created_by" value="{{ resident.care_manager }}" readonly>
  </div>
</div>

          <div class="mb-3">
            <label class="form-label">ç”Ÿæ´»æ­´</label>
            <textarea class="form-control" name="history" rows="3" placeholder="ä¾‹ï¼šè¾²æ¥­ã‚’é•·å¹´ã—ã¦ãŠã‚Šã€èº«ä½“ã‚’å‹•ã‹ã™ç¿’æ…£ãŒã‚ã‚‹"></textarea>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label class="form-label">æœ¬äººã®å¸Œæœ›</label>
              <textarea class="form-control" name="wish_self" rows="3" placeholder="ä¾‹ï¼šã“ã‚Œã¾ã§é€šã‚Šè‡ªå®…ã§éã”ã—ãŸã„"></textarea>
            </div>
            <div class="col-md-6 mb-3">
              <label class="form-label">å®¶æ—ã®å¸Œæœ›</label>
              <textarea class="form-control" name="wish_family" rows="3" placeholder="ä¾‹ï¼šå®‰å…¨ãªç’°å¢ƒã§ç©ã‚„ã‹ã«éã”ã—ã¦ã»ã—ã„"></textarea>
            </div>
          </div>
        </div>
      </div>

      <!-- ä»–ã®ã‚«ãƒ¼ãƒ‰ -->
<div class="card">
  <div class="card-header">ä¿é™ºæƒ…å ±</div>
  <div class="card-body">
    <!-- â–¼ èª­ã¿å–ã‚Šå°‚ç”¨ï¼šç™»éŒ²æ¸ˆæƒ…å ± -->
    <div class="row mb-3">
      <div class="col-md-4">
        <label class="form-label">ä»‹è­·ä¿é™ºè¢«ä¿é™ºè€…ç•ªå·</label>
        <input type="text" class="form-control" value="{{ resident.insurance_number }}" readonly>
      </div>
      <div class="col-md-4">
        <label class="form-label">è¦ä»‹è­·åº¦</label>
        <input type="text" class="form-control" value="{{ resident.care_level }}" readonly>
      </div>
      <div class="col-md-4">
        <label class="form-label">èªå®šæ—¥</label>
        <input type="date" class="form-control" value="{{ resident.certification_date }}" readonly>
      </div>
    </div>

<!-- â–¼ èªå®šæœ‰åŠ¹æœŸé–“ï¼šæ—¥ä»˜ï¼‹å’Œæš¦è¡¨ç¤º -->
<div class="row mb-3">
  <!-- èªå®šæœ‰åŠ¹æœŸé–“ -->
  <div class="col-md-8">
    <label class="form-label">èªå®šæœ‰åŠ¹æœŸé–“</label>
    <div class="row g-2 align-items-center mb-2">
      <div class="col-auto">
        <input type="date" name="insurance_start" class="form-control" id="insurance_start" value="{{ resident.insurance_start }}" readonly>
      </div>
      <div class="col-auto">
        <span class="form-label">ã€œ</span>
      </div>
      <div class="col-auto">
        <input type="date" name="insurance_end" class="form-control" id="insurance_end" value="{{ resident.insurance_end }}" readonly>
      </div>
    </div>
    <!-- å’Œæš¦è¡¨ç¤º -->
    <div class="form-text" id="insurance_wareki_display" style="font-size: 1rem; color: #444;">
      <!-- JavaScriptã§è‡ªå‹•è¡¨ç¤ºã•ã‚Œã¾ã™ -->
    </div>
  </div>

  <!-- è² æ‹…å‰²åˆ -->
  <div class="col-md-4">
    <label class="form-label">è² æ‹…å‰²åˆ</label>
    <select name="burden_ratio" class="form-select">
      <option value="">é¸æŠ</option>
      <option value="1å‰²">1å‰²</option>
      <option value="2å‰²">2å‰²</option>
      <option value="3å‰²">3å‰²</option>
    </select>
  </div>
</div>

<div class="row mb-3">
  <!-- åŒ»ç™‚ä¿é™ºï¼ˆã‚»ãƒ¬ã‚¯ãƒˆï¼‰ -->
  <div class="col-md-6">
    <label class="form-label">åŒ»ç™‚ä¿é™º</label>
    <select name="medical_insurance" class="form-select">
      <option value="">é¸æŠ</option>
      <option value="å¾ŒæœŸé«˜é½¢è€…åŒ»ç™‚ä¿é™º">å¾ŒæœŸé«˜é½¢è€…åŒ»ç™‚ä¿é™º</option>
      <option value="å›½æ°‘å¥åº·ä¿é™º">å›½æ°‘å¥åº·ä¿é™º</option>
      <option value="ãã®ä»–">ãã®ä»–</option>
    </select>
  </div>

  <!-- ãã®ä»–ã®åŒ»ç™‚ä¿é™ºï¼ˆå…¥åŠ›æ¬„ï¼‰ -->
  <div class="col-md-6">
    <label class="form-label">ãã®ä»–ã®åŒ»ç™‚ä¿é™º</label>
    <input type="text" name="medical_insurance_other" class="form-control" placeholder="ãã®ä»–ã®å ´åˆã€è¨˜è¼‰">
  </div>
</div>

    <div class="row mb-3">
      <div class="col-md-3">
        <label class="form-label">èº«ä½“éšœãŒã„è€…æ‰‹å¸³</label>
        <select name="has_disability_card" class="form-select">
          <option value="">é¸æŠ</option>
          <option value="æœ‰">æœ‰</option>
          <option value="ç„¡">ç„¡</option>
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">æ‰‹å¸³ã®ç¨®é¡</label>
        <select name="disability_grade" class="form-select">
          <option value="">æœ‰ï½œé¸æŠ</option>
          <option value="1ç´š1ç¨®">1ç´š1ç¨®</option>
          <option value="1ç´š2ç¨®">1ç´š2ç¨®</option>
          <option value="2ç´š1ç¨®">2ç´š1ç¨®</option>
          <option value="2ç´š2ç¨®">2ç´š2ç¨®</option>
          <option value="3ç´š1ç¨®">3ç´š1ç¨®</option>
          <option value="3ç´š2ç¨®">3ç´š2ç¨®</option>
          <option value="4ç´š1ç¨®">4ç´š1ç¨®</option>
          <option value="4ç´š2ç¨®">4ç´š2ç¨®</option>
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">é›£ç—…ç”³è«‹</label>
        <select name="has_intractable_disease" class="form-select">
          <option value="">é¸æŠ</option>
          <option value="æœ‰">æœ‰</option>
          <option value="ç„¡">ç„¡</option>
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">ç”Ÿæ´»ä¿è­·</label>
        <select name="has_livelihood_protection" class="form-select">
          <option value="">é¸æŠ</option>
          <option value="æœ‰">æœ‰</option>
          <option value="ç„¡">ç„¡</option>
        </select>
      </div>
    </div>

    <div class="row mb-3">
      <div class="col-md-6">
        <label class="form-label">éšœãŒã„è€…æ—¥å¸¸ç”Ÿæ´»è‡ªç«‹åº¦</label>
        <select name="disability_life_independence" class="form-select">
          <option value="">é¸æŠ</option>
          <option value="è‡ªç«‹">è‡ªç«‹</option>
          <option value="J1">J1</option>
          <option value="J2">J2</option>
          <option value="A1">A1</option>
          <option value="A2">A2</option>
          <option value="B1">B1</option>
          <option value="B2">B2</option>
          <option value="C1">C1</option>
          <option value="C2">C2</option>
        </select>
      </div>
      <div class="col-md-6">
        <label class="form-label">èªçŸ¥ç—‡æ—¥å¸¸ç”Ÿæ´»è‡ªç«‹åº¦</label>
        <select name="dementia_life_independence" class="form-select">
          <option value="">é¸æŠ</option>
          <option value="è‡ªç«‹">è‡ªç«‹</option>
          <option value="â… ">1</option>
          <option value="â…¡a">â…¡a</option>
          <option value="â…¡b">â…¡b</option>
          <option value="â…¢a">â…¢a</option>
          <option value="â…¢b">â…¢b</option>
          <option value="â…£">â…£</option>
          <option value="ï¼­">ï¼­</option>
        </select>
      </div>
    </div>
  </div>
</div>

<div class="accordion mt-4" id="accordion-housing">
  <div class="accordion-item">
    <h2 class="accordion-header" id="heading-housing">
      <button class="accordion-button keep-bg collapsed" type="button"
              data-bs-toggle="collapse"
              data-bs-target="#collapse-housing"
              aria-expanded="false" aria-controls="collapse-housing">
        ğŸ‘ª å®¶æ—çŠ¶æ³
      </button>
    </h2>
    <div id="collapse-housing" class="accordion-collapse collapse"
         aria-labelledby="heading-housing" data-bs-parent="#accordion-housing">
      <div class="accordion-body p-0">
        <div class="p-3">

            <!-- å®¶æ—â‘  -->
            <div class="mb-3">
              <h6 class="fw-bold mb-3 text-primary">ğŸ‘¤ å®¶æ— 1</h6>
              <div class="row mb-2">
                <div class="col-md-4">
                  <label class="form-label">å®¶æ—æ°å</label>
                  <input type="text" name="family_name_1" class="form-control">
                </div>
                <div class="col-md-4">
                  <label class="form-label">ç¶šæŸ„</label>
                  <input type="text" name="relationship_1" class="form-control" placeholder="ä¾‹ï¼šé•·ç”·ãƒ»é…å¶è€…ãªã©">
                </div>
                <div class="col-md-4">
                  <label class="form-label">é€£çµ¡å…ˆ</label>
                  <input type="text" name="family_phone_1" class="form-control">
                </div>
              </div>

              <div class="row mb-2">
                <div class="col-md-4">
                  <label class="form-label">åŒå±…ã®æœ‰ç„¡</label>
                  <select name="living_together_1" class="form-select">
                    <option value="">é¸æŠ</option>
                    <option value="åŒå±…">åŒå±…</option>
                    <option value="åˆ¥å±…">åˆ¥å±…</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label">ä»‹è­·ã®æœ‰ç„¡</label>
                  <select name="is_caregiver_1" class="form-select">
                    <option value="">é¸æŠ</option>
                    <option value="æœ‰">æœ‰</option>
                    <option value="ç„¡">ç„¡</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label">å°±åŠ´çŠ¶æ³</label>
                  <select name="working_status_1" class="form-select">
                    <option value="">é¸æŠ</option>
                    <option value="å°±åŠ´ä¸­">å°±åŠ´ä¸­</option>
                    <option value="é€€è·æ¸ˆ">é€€è·æ¸ˆ</option>
                    <option value="ãã®ä»–">ãã®ä»–</option>
                  </select>
                </div>
              </div>

              <div class="mb-4">
                <label class="form-label">å‚™è€ƒ</label>
                <textarea name="family_note_1" class="form-control" rows="2" placeholder="è£œè¶³ãŒã‚ã‚Œã°è¨˜å…¥ã—ã¦ãã ã•ã„"></textarea>
              </div>
            </div>
            <hr>

            <!-- å®¶æ—â‘¡ -->
            <div class="mb-3">
              <h6 class="fw-bold mb-3 text-primary">ğŸ‘¤ å®¶æ— 2</h6>
              <div class="row mb-2">
                <div class="col-md-4">
                  <label class="form-label">å®¶æ—æ°å</label>
                  <input type="text" name="family_name_2" class="form-control">
                </div>
                <div class="col-md-4">
                  <label class="form-label">ç¶šæŸ„</label>
                  <input type="text" name="relationship_2" class="form-control" placeholder="ä¾‹ï¼šé•·ç”·ãƒ»é…å¶è€…ãªã©">
                </div>
                <div class="col-md-4">
                  <label class="form-label">é€£çµ¡å…ˆ</label>
                  <input type="text" name="family_phone_2" class="form-control">
                </div>
              </div>

              <div class="row mb-2">
                <div class="col-md-4">
                  <label class="form-label">åŒå±…ã®æœ‰ç„¡</label>
                  <select name="living_together_2" class="form-select">
                    <option value="">é¸æŠ</option>
                    <option value="åŒå±…">åŒå±…</option>
                    <option value="åˆ¥å±…">åˆ¥å±…</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label">ä»‹è­·ã®æœ‰ç„¡</label>
                  <select name="is_caregiver_2" class="form-select">
                    <option value="">é¸æŠ</option>
                    <option value="æœ‰">æœ‰</option>
                    <option value="ç„¡">ç„¡</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label">å°±åŠ´çŠ¶æ³</label>
                  <select name="working_status_2" class="form-select">
                    <option value="">é¸æŠ</option>
                    <option value="å°±åŠ´ä¸­">å°±åŠ´ä¸­</option>
                    <option value="é€€è·æ¸ˆ">é€€è·æ¸ˆ</option>
                    <option value="ãã®ä»–">ãã®ä»–</option>
                  </select>
                </div>
              </div>

              <div class="mb-4">
                <label class="form-label">å‚™è€ƒ</label>
                <textarea name="family_note_2" class="form-control" rows="2" placeholder="è£œè¶³ãŒã‚ã‚Œã°è¨˜å…¥ã—ã¦ãã ã•ã„"></textarea>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="accordion mt-4" id="accordion-housing-env">
  <div class="accordion-item">
    <h2 class="accordion-header" id="heading-housing-env">
      <button class="accordion-button keep-bg collapsed" type="button"
              data-bs-toggle="collapse"
              data-bs-target="#collapse-housing-env"
              aria-expanded="false" aria-controls="collapse-housing-env">
        ğŸ  ä½å±…çŠ¶æ³
      </button>
    </h2>
    <div id="collapse-housing-env" class="accordion-collapse collapse"
         aria-labelledby="heading-housing-env" data-bs-parent="#accordion-housing-env">
      <div class="accordion-body p-3">

<div class="row mb-4 align-items-start">
  <!-- å·¦å´ãƒ©ãƒ™ãƒ« -->
  <div class="col-md-2">
    <label class="form-label mb-0">å®¶åº­ç’°å¢ƒ</label>
  </div>

  <!-- å³å´ãƒœã‚¿ãƒ³ç¾¤ -->
  <div class="col-md-10">
    <div class="btn-group flex-wrap" role="group" aria-label="å®¶åº­ç’°å¢ƒ">
      <input type="checkbox" class="btn-check" id="env1" name="household[]" value="å®¶æ—åŒå±…">
      <label class="btn btn-outline-primary btn-sm me-1 mb-1" for="env1">å®¶æ—åŒå±…</label>

      <input type="checkbox" class="btn-check" id="env2" name="household[]" value="ä¸€äººæš®ã‚‰ã—">
      <label class="btn btn-outline-primary btn-sm me-1 mb-1" for="env2">ä¸€äººæš®ã‚‰ã—</label>

      <input type="checkbox" class="btn-check" id="env3" name="household[]" value="é«˜é½¢æ‰€å¸¯">
      <label class="btn btn-outline-primary btn-sm me-1 mb-1" for="env3">é«˜é½¢æ‰€å¸¯</label>

      <input type="checkbox" class="btn-check" id="env4" name="household[]" value="æ—¥ä¸­ç‹¬å±…">
      <label class="btn btn-outline-primary btn-sm me-1 mb-1" for="env4">æ—¥ä¸­ç‹¬å±…</label>

      <input type="checkbox" class="btn-check" id="env5" name="household[]" value="äºŒä¸–å¸¯ä½å®…">
      <label class="btn btn-outline-primary btn-sm me-1 mb-1" for="env5">äºŒä¸–å¸¯ä½å®…</label>
    </div>
  </div>
</div>

        <!-- âœ… é …ç›®ç¾¤ï¼š2ã€œ3åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ -->
        <div class="row g-3">

          <!-- 1è¡Œç›® -->
          <div class="col-md-3">
            <label class="form-label">ä½å±…å½¢æ…‹</label>
            <select name="housing_type" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="ä¸€æˆ¸å»ºã¦">ä¸€æˆ¸å»ºã¦</option>
              <option value="é›†åˆä½å®…">é›†åˆä½å®…</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">ä½å®…æ¨©åˆ©</label>
            <select name="housing_right" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æ‰€æœ‰">æ‰€æœ‰</option>
              <option value="è³ƒè²¸">è³ƒè²¸</option>
              <option value="é–“å€Ÿã‚Š">é–“å€Ÿã‚Š</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">å°‚æœ‰å±…å®¤</label>
            <select name="private_room" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">å±…å®¤æ®µå·®</label>
            <select name="room_step" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
          </div>

          <!-- 2è¡Œç›® -->
          <div class="col-md-4">
            <label class="form-label">æ®µå·®</label>
            <select name="step" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label">å°±å¯</label>
            <select name="bedding" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="ç•³ãƒ»åºŠ">ç•³ãƒ»åºŠ</option>
              <option value="ãƒ™ãƒƒãƒ‰">ãƒ™ãƒƒãƒ‰</option>
              <option value="ãƒªã‚¯ãƒ©ã‚¤ãƒ‹ãƒ³ã‚°ãƒ™ãƒƒãƒ‰">ãƒªã‚¯ãƒ©ã‚¤ãƒ‹ãƒ³ã‚°ãƒ™ãƒƒãƒ‰</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label">å†·æš–æˆ¿</label>
            <select name="air_conditioning" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
          </div>

          <!-- 3è¡Œç›® -->
          <div class="col-md-3">
            <label class="form-label">ãƒˆã‚¤ãƒ¬</label>
            <select name="toilet_type" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æ´‹å¼">æ´‹å¼</option>
              <option value="å’Œå¼">å’Œå¼</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">ãƒˆã‚¤ãƒ¬å†…æ‰‹ã™ã‚Š</label>
            <select name="toilet_handle" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">æµ´å®¤</label>
            <select name="bathroom" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
          </div>
          <div class="col-md-3">
            <label class="form-label">æµ´å®¤å†…æ‰‹ã™ã‚Š</label>
            <select name="bathroom_handle" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
          </div>
<div class="mt-2 mb-3">
  <hr class="border-top border-1 border-secondary">
</div>
<!-- â–¼ ä½å±…å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‹è¡¨ç¤º -->
<div class="mb-3">
  <label class="form-label fw-bold">ä½å±…ã®å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆè¤‡æ•°å¯ï¼‰</label>
  <input type="file" name="housing_photos[]" accept="image/*" multiple class="form-control mb-2">

  <!-- æœ€æ–°2æšã®ã¿è¡¨ç¤º -->
  <div class="d-flex flex-wrap gap-2 mt-2">
    {% for img in housing_photos[:2] %}
      <img src="{{ url_for('static', filename='uploads/' + img) }}" class="img-thumbnail" style="max-width: 150px;">
    {% endfor %}
  </div>

  {% if housing_photos|length > 2 %}
    <div class="mt-2">
      <a href="{{ url_for('view_all_photos', category='housing') }}" class="btn btn-sm btn-outline-primary">
        ğŸ“· ã™ã¹ã¦ã®å†™çœŸã‚’è¦‹ã‚‹
      </a>
    </div>
  {% endif %}
</div>
<hr class="border-top border-1 border-secondary my-2">

<!-- æ–°ã—ã„ row ã‚¹ã‚¿ãƒ¼ãƒˆ -->
<div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">ä½å®…æ”¹ä¿®</label>
            <select name="housing_renovation" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">ä½å®…æ”¹ä¿®ã®å¿…è¦æ€§</label>
            <select name="renovation_need" class="form-select">
              <option value="">é¸æŠ</option>
              <option value="æœ‰">æœ‰</option>
              <option value="ç„¡">ç„¡</option>
            </select>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>

<div class="accordion mt-4" id="accordion-usage">
  <div class="accordion-item">
    <h2 class="accordion-header" id="heading-usage">
      <button class="accordion-button keep-bg collapsed" type="button"
              data-bs-toggle="collapse" data-bs-target="#collapse-usage"
              aria-expanded="false" aria-controls="collapse-usage">
        ğŸ‘¥ åˆ©ç”¨ã‚µãƒ¼ãƒ“ã‚¹
      </button>
    </h2>
    <div id="collapse-usage" class="accordion-collapse collapse"
         aria-labelledby="heading-usage" data-bs-parent="#accordion-usage">
      <div class="accordion-body">

        <!-- ä»‹è­·ã‚µãƒ¼ãƒ“ã‚¹ -->
<!-- â–¼ å„ã‚µãƒ¼ãƒ“ã‚¹å…±é€šã®è¡¨ç¤ºãƒœã‚¿ãƒ³ãƒ»çµæœãƒ»hidden -->
<!-- ä»‹è­·ã‚µãƒ¼ãƒ“ã‚¹ -->
<div class="mb-3 d-flex align-items-center">
  <label class="form-label me-3 mb-0" style="min-width: 120px;">ä»‹è­·ã‚µãƒ¼ãƒ“ã‚¹</label>
  <button type="button" class="btn btn-outline-primary btn-sm" onclick="openServiceModal('care')">é¸æŠ</button>
</div>
<div id="selected-care" class="mb-2 small text-muted ms-2"></div>
<input type="hidden" name="care_services" id="input-care">

<div class="mb-3 d-flex align-items-center">
  <label class="form-label me-3 mb-0" style="min-width: 120px;">ç¦ç¥‰ç”¨å…·</label>
  <button type="button" class="btn btn-outline-primary btn-sm" onclick="openServiceModal('welfare')">é¸æŠ</button>
</div>
<div id="selected-welfare" class="mb-2 small text-muted ms-2"></div>
<input type="hidden" name="welfare_items" id="input-welfare">

        <!-- ä¸Šè¨˜ä»¥å¤–ã®ã‚µãƒ¼ãƒ“ã‚¹ -->
        <div class="mb-3">
          <label class="form-label">ä¸Šè¨˜ä»¥å¤–ã®ã‚µãƒ¼ãƒ“ã‚¹</label>
          <textarea name="other_services" class="form-control" rows="2" placeholder="è‡ªç”±ã«ã”è¨˜å…¥ãã ã•ã„"></textarea>
        </div>

<!-- ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹ -->
<div class="mb-3 d-flex align-items-center">
  <label class="form-label me-3 mb-0" style="min-width: 120px;">ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒãƒ«ã‚µãƒ¼ãƒ“ã‚¹</label>
  <button type="button" class="btn btn-outline-primary btn-sm" onclick="openServiceModal('informal')">é¸æŠ</button>
</div>
<div id="selected-informal" class="mb-2 small text-muted ms-2"></div>
<input type="hidden" name="informal_services" id="input-informal">

        <!-- ç¤¾ä¼šã¨ã®é–¢ã‚ã‚Š -->
        <div class="mb-3">
          <label class="form-label">ç¤¾ä¼šã¨ã®é–¢ã‚ã‚Š</label>
          <textarea name="social_connection" class="form-control" rows="2" placeholder="ä¾‹ï¼šè¿‘æ‰€ã®é›†ã¾ã‚Šã«é€±1å›å‚åŠ ã—ã¦ã„ã‚‹"></textarea>
        </div>

      </div>
    </div>
  </div>
</div>

    <!-- â–¼ èº«ä½“ã®çŠ¶æ³ -->
    <div class="panel-content" id="panel-body">
      <div class="card">
        <div class="card-header">å¥åº·çŠ¶æ…‹</div>
        <div class="card-body">ã“ã“ã«å¥åº·çŠ¶æ…‹</div>
      </div>
      <div class="card">
        <div class="card-header">èº«ä½“çŠ¶æ³</div>
        <div class="card-body">ã“ã“ã«èº«ä½“çŠ¶æ³</div>
      </div>
      <div class="card">
        <div class="card-header">åŸºæœ¬å‹•ä½œ</div>
        <div class="card-body">ã“ã“ã«å‹•ä½œé …ç›®</div>
      </div>
      <div class="card">
        <div class="card-header">èªçŸ¥</div>
        <div class="card-body">ã“ã“ã«èªçŸ¥é …ç›®</div>
      </div>
    </div>

    <!-- â–¼ æ—¥å¸¸ç”Ÿæ´»å‹•ä½œ -->
    <div class="panel-content" id="panel-adl">
      <div class="card">
        <div class="card-header">é£Ÿäº‹</div>
        <div class="card-body">ã“ã“ã«é£Ÿäº‹æƒ…å ±</div>
      </div>
      <div class="card">
        <div class="card-header">å£è…”</div>
        <div class="card-body">ã“ã“ã«å£è…”æƒ…å ±</div>
      </div>
      <div class="card">
        <div class="card-header">å…¥æµ´</div>
        <div class="card-body">ã“ã“ã«å…¥æµ´æƒ…å ±</div>
      </div>
      <div class="card">
        <div class="card-header">æ›´è¡£</div>
        <div class="card-body">ã“ã“ã«æ›´è¡£æƒ…å ±</div>
      </div>
      <div class="card">
        <div class="card-header">æ’æ³„</div>
        <div class="card-body">ã“ã“ã«æ’æ³„æƒ…å ±</div>
      </div>
      <div class="card">
        <div class="card-header">IADL</div>
        <div class="card-body">ã“ã“ã«IADLæƒ…å ±</div>
      </div>
    </div>

    <!-- â–¼ ç‰¹è¨˜äº‹é … -->
    <div class="panel-content" id="panel-notes">
      <div class="card">
        <div class="card-header">ç‰¹è¨˜äº‹é …</div>
        <div class="card-body">ã“ã“ã«ç‰¹è¨˜äº‹é …</div>
      </div>
    </div>

    <!-- ä¿å­˜ãƒœã‚¿ãƒ³ -->
    <div class="text-center mt-4">
      <button type="submit" class="btn btn-primary">ä¿å­˜ã™ã‚‹</button>
    </div>
  </form>
</div>

<script>
  function showPanel(targetId) {
    document.querySelectorAll('.panel-tab').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.panel-content').forEach(panel => panel.classList.remove('active'));
    document.querySelector(`#panel-${targetId}`).classList.add('active');
    event.target.classList.add('active');
  }

  function toWareki(value) {
    const date = new Date(value);
    const y = date.getFullYear();
    const m = date.getMonth() + 1;
    const d = date.getDate();
    if (isNaN(y)) return "";
    if (y >= 2019) return `ä»¤å’Œ${y - 2018}å¹´${m}æœˆ${d}æ—¥`;
    if (y >= 1989) return `å¹³æˆ${y - 1988}å¹´${m}æœˆ${d}æ—¥`;
    if (y >= 1926) return `æ˜­å’Œ${y - 1925}å¹´${m}æœˆ${d}æ—¥`;
    return `${y}å¹´${m}æœˆ${d}æ—¥`;
  }

  function updatePeriodDisplay() {
    const start = toWareki(document.getElementById("insurance_start").value);
    const end = toWareki(document.getElementById("insurance_end").value);
    const display = document.getElementById("insurance_wareki_display");
    display.textContent = start && end ? `${start} ã€œ ${end}` : (start || '') + (start && end ? ' ã€œ ' : '') + (end || '');
  }

  document.getElementById("insurance_start")?.addEventListener("change", updatePeriodDisplay);
  document.getElementById("insurance_end")?.addEventListener("change", updatePeriodDisplay);
  document.addEventListener("DOMContentLoaded", updatePeriodDisplay);

  // å…¥åŠ›ã•ã‚Œã¦ã„ãªã„é …ç›®ã‚’è–„ã„é»„è‰²ã«ã™ã‚‹
  document.addEventListener('DOMContentLoaded', function () {
    const inputs = document.querySelectorAll('input, select, textarea');

    function checkEmpty(el) {
      if (!el.readOnly && !el.disabled && el.value.trim() === '') {
        el.classList.add('highlight-empty');
      } else {
        el.classList.remove('highlight-empty');
      }
    }

    inputs.forEach(el => {
      checkEmpty(el); // åˆæœŸçŠ¶æ…‹ã®ãƒã‚§ãƒƒã‚¯
      el.addEventListener('change', () => checkEmpty(el));
      el.addEventListener('input', () => checkEmpty(el));
    });
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const serviceOptions = {
    care: ['è¨ªå•ä»‹è­·', 'è¨ªå•å…¥æµ´', 'è¨ªå•çœ‹è­·', 'è¨ªå•ãƒªãƒ', 'é€šæ‰€ä»‹è­·', 'é€šæ‰€ãƒªãƒ', 'ã‚·ãƒ§ãƒ¼ãƒˆã‚¹ãƒ†ã‚¤'],
    welfare: ['è»Šæ¤…å­', 'è»Šæ¤…å­ä»˜å±å“', 'ç‰¹æ®Šå¯å°', 'ç‰¹æ®Šå¯å°ä»˜å±å“', 'åºŠãšã‚Œé˜²æ­¢ç”¨å…·', 'ä½“ä½å¤‰æ›å™¨', 'æ‰‹ã™ã‚Š', 'ã‚¹ãƒ­ãƒ¼ãƒ—', 'æ­©è¡Œå™¨', 'æ­©è¡Œè£œåŠ©ã¤ãˆ', 'å¾˜å¾Šæ„ŸçŸ¥æ©Ÿå™¨', 'ç§»å‹•ç”¨ãƒªãƒ•ãƒˆ', 'è‡ªå‹•æ’æ³„å‡¦ç†è£…ç½®'],
    informal: ['ã‚ªãƒ ãƒ„æ”¯çµ¦', 'é£Ÿäº‹æ”¯æ´', 'æ’æ³„æ”¯æ´', 'ãƒªãƒãƒ³ãƒªãƒ¼ã‚¹', 'æ´—æ¿¯', 'å±…å®¤æ¸…æƒ', 'å–€ç—°å¸å¼•', 'ç«ç½å ±çŸ¥å™¨', 'è‡ªå‹•æ¶ˆç«å™¨', 'è€äººç”¨é›»è©±', 'å¯å…·ä¹¾ç‡¥æ¶ˆæ¯’', 'é›»ç£èª¿ç†å™¨', 'ç·Šæ€¥é€šå ±è£…ç½®', 'ãƒœãƒ©ãƒ³ãƒ†ã‚£ã‚¢', 'é…é£Ÿã‚µãƒ¼ãƒ“ã‚¹', 'ä»‹è­·æ…°åŠ´', 'ã‚¿ã‚¯ã‚·ãƒ¼åˆ¸', 'ãƒãƒƒã‚µãƒ¼ã‚¸ä»¶']
  };

  let currentCategory = "";

  function openServiceModal(category) {
    currentCategory = category;
    const options = serviceOptions[category];
    const container = document.getElementById('modal-options');
    container.innerHTML = "";

    options.forEach((item, i) => {
      const id = `${category}_${i}`;
      container.innerHTML += `
        <div class="col-md-4">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="${item}" id="${id}">
            <label class="form-check-label" for="${id}">${item}</label>
          </div>
        </div>`;
    });

    const modal = new bootstrap.Modal(document.getElementById('serviceModal'));
    modal.show();
  }

  function confirmSelection() {
    const checkboxes = document.querySelectorAll('#modal-options input[type=checkbox]');
    const selected = Array.from(checkboxes).filter(cb => cb.checked).map(cb => cb.value);

    document.getElementById(`selected-${currentCategory}`).innerText = selected.join(', ');
    document.getElementById(`input-${currentCategory}`).value = selected.join(',');

    bootstrap.Modal.getInstance(document.getElementById('serviceModal')).hide();
  }
</script>
<!-- â–¼ ãƒ¢ãƒ¼ãƒ€ãƒ«å…±é€šéƒ¨ -->
<div class="modal fade" id="serviceModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">ã‚µãƒ¼ãƒ“ã‚¹é¸æŠ</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div id="modal-options" class="row"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn btn-primary" onclick="confirmSelection()">æ±ºå®š</button>
      </div>
    </div>
  </div>
</div>


</body>
</html>